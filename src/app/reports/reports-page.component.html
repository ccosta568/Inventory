<section class="reports" *ngIf="report$ | async as report">
  <header>
    <p class="eyebrow">Insights</p>
    <h2>At-a-glance performance</h2>
    <p class="subtitle">Track inventory levels, event activity, and top sellers.</p>
  </header>

  <div class="metrics">
    <div class="metric-card">
      <p class="label">On-hand inventory</p>
      <p class="value">{{ report.totalOnHand }}</p>
    </div>
    <div class="metric-card">
      <p class="label">Events logged</p>
      <p class="value">{{ report.eventCount }}</p>
    </div>
    <div class="metric-card">
      <p class="label">Units sold</p>
      <p class="value">{{ report.totalSold }}</p>
    </div>
    <div class="metric-card">
      <p class="label">Total revenue</p>
      <p class="value">{{ report.totalRevenue | currency:'USD':'symbol':'1.0-0' }}</p>
    </div>
  </div>

  <div class="best-sellers">
    <h3>Top sellers</h3>
    <div *ngIf="report.bestSellers.length; else emptyState" class="seller-list">
      <div class="seller-card" *ngFor="let entry of report.bestSellers">
        <div class="seller-header">
          <div>
            <p class="title">{{ entry.title }}</p>
            <p class="format" *ngIf="entry.format">{{ entry.format }}</p>
          </div>
          <div class="totals">
            <span>{{ entry.totalUnits }} sold</span>
            <strong>{{ entry.totalRevenue | currency:'USD':'symbol':'1.0-0' }}</strong>
          </div>
        </div>
        <ul class="tier-breakdown">
          <li *ngFor="let tier of entry.tiers">
            <span>{{ tier.qty }} &#64; {{ tier.price | currency:'USD':'symbol':'1.0-0' }}</span>
            <span>{{ tier.revenue | currency:'USD':'symbol':'1.0-0' }}</span>
          </li>
        </ul>
      </div>
    </div>
    <ng-template #emptyState>
      <p class="empty">No sales logged yet.</p>
    </ng-template>
  </div>
</section>
